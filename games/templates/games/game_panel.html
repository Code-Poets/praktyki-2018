<!DOCTYPE html>
<html>
<head>
    {% load static %}
    {% load i18n %}
  <title>{% block title %}{{ game.name }}{% endblock %}</title>
  <meta name="description" content="Free Web tutorials">
  <meta name="keywords" content="HTML,CSS,XML,JavaScript">
  <meta name="author" content="John Doe">
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">

    <style>
        body{
            background: #FCD697
        }

        img {
            width:50%;
        }
    </style>

    <link rel="stylesheet" type="text/css" href="{% static 'games/style2.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'button.css' %}" />
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" />

    <SCRIPT LANGUAGE="JavaScript">
        function getCookie(name)
        {
            var start = document.cookie.indexOf( name + "=" );
            var len = start + name.length + 1;
            if ( ( !start ) && ( name != document.cookie.substring( 0, name.length ) ) ) {
                return null;
            }
            if ( start == -1 ) return null;
            var end = document.cookie.indexOf( ";", len );
            if ( end == -1 ) end = document.cookie.length;
            return unescape( document.cookie.substring( len, end ) );
        }

        function doload()
        {
            var scrollTop = getCookie ("scrollTop");
            var scrollLeft = getCookie("scrollLeft");

            if (!isNaN(scrollTop))
            {
		          document.body.scrollTop = scrollTop;
		          document.documentElement.scrollTop = scrollTop;

            }
            if (!isNaN(scrollLeft))
          	{
          			  document.body.scrollLeft = scrollLeft;
          			  document.documentElement.scrollLeft = scrollLeft;
            }

            Delete_Cookie("scrollTop");
            Delete_Cookie("scrollLeft");
            setTimeout( "Refresh()", 10000 );
        }

        function Refresh()
        {
            document.cookie = 'scrollTop=' + f_scrollTop();
            document.cookie = 'scrollLeft=' + f_scrollLeft();
            document.location.reload(true);
        }

        //Setting the cookie for vertical position
        function f_scrollTop() {
            return f_filterResults (
                window.pageYOffset ? window.pageYOffset : 0,
                document.documentElement ? document.documentElement.scrollTop : 0,
                document.body ? document.body.scrollTop : 0
            );
        }

        function f_filterResults(n_win, n_docel, n_body) {
            var n_result = n_win ? n_win : 0;
            if (n_docel && (!n_result || (n_result > n_docel)))
                n_result = n_docel;
            return n_body && (!n_result || (n_result > n_body)) ? n_body : n_result;
        }

        //Setting the cookie for horizontal position
        function f_scrollLeft() {
            return f_filterResults (
                window.pageXOffset ? window.pageXOffset : 0,
                document.documentElement ? document.documentElement.scrollLeft : 0,
                document.body ? document.body.scrollLeft : 0
            );
        }

        function Delete_Cookie(name)
        {
            document.cookie = name + "=" + ";expires=Thu, 01-Jan-1970 00:00:01 GMT";

        }
        window.onload=doload;
    </SCRIPT>


      <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
      <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
      <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

      <script>
      $( function() {
        $( "#dialog" ).dialog();
      } );
      </script>

      <script type="text/javascript">
      //<script type="text/javascript" src="{% static 'games/game_panel.js' %}">
      function myFunction(id) {
          var count = 0;
          /*
          {% for gamer in gamers.all %}
            if ( {{ gamer.order }} == id){
              document.write('<table bgcolor="ffe5ba"><tr><td>{{ gamer.nick }}</td><td>{{ gamer.order }}</td></tr></table>');
              if ( {{ gamer.gender }} == "None"){
                document.write("None");
              }

              count = count + 1;
            }
          {% endfor %}
          if (count == 0){
            document.write("{% trans 'Free place for gamer' %}");
          }
          */
          /*
          document.write("<p>{{ gamers.0.nick }}</p>");
          if ( "{{ gamers.0.gender }}" == "Female"){
            document.write('<img src="{% static "games/images/female.png" %}" alt="Fema"le" style="width:10%;">');
          }
          */
          {% for gamer in gamers.all %}
            {% if gamer.order is not null %}
            if ( {{ gamer.order }} == id){
              document.write('<table id="gamer" bgcolor="ffe5ba"><col width="25%"><col width="25%"><col width="25%"><col width="25%">');
              document.write('<tr align="center"><td style="border: 1px solid black;border-style: dotted;"><font color="DimGray" size="3">'+id+'</font></td>');
              document.write('<td colspan="2"><font size="5%">{{ gamer.nick }}</font></td>');
              document.write('<td align="left">');
              if ("{{ gamer.gender }}" == "Female"){
                document.write('<img src="{% static "games/images/female.png" %}" alt="Female" style="width:40%;">');
              }
              else if ("{{ gamer.gender }}" == "Male") {
                document.write('<img src="{% static "games/images/male.png" %}" alt="Male" style="width:40%;">');
              }
              else{
                document.write('<img src="{% static "games/images/none.png" %}" alt="None" style="width:40%;">');
              }
              document.write('</td></tr>');

              {% if gamers.0.status is not None and gamers.0.status != "" %}
                  document.write('<tr><td align="center" colspan="4" style="word-wrap:break-word"><font color="#cc7e00" size="1%">"{{ gamer.status }}"</font></td></tr>');
              {% else %}
                  document.write('<tr><td id="status" colspan="4" style="word-wrap:break-word"><font color="ffe5ba" size="1%">Status</font></td></tr>');
              {% endif %}

              document.write('<tr><td align="center" colspan="2"><font size="1%" color="DimGray">Lvl: <font size="6%" color="red">{{ gamer.level }}</font</td>');
              document.write('<td align="left" colspan="2"><font size="1%"color="DimGray">Bonus: <font size="6%" color="green">{{ gamer.bonus }}</font></td></tr>');

              document.write('<tr align="center"><td colspan="2"><font size="2%" color="DimGray">{% trans "Race" %}: </font></td>');
              document.write('<td colspan="2"><font size="2%" color="DimGray">{% trans "Class" %}: </font></td></tr>');

              document.write('<tr align="center"><td colspan="2">');
              {% if gamer.race_slot_1 != None %}
                document.write('{{ gamer.race_slot_1 }}');
              {% else %}
                document.write('<font color="ffe5ba">{% trans "Race" %}: </font>');
              {% endif %}
              document.write('</td><td colspan="2">');
              {% if gamer.class_slot_1 != None %}
                document.write('{{ gamer.class_slot_1 }}');
              {% else %}
                document.write('<font color="ffe5ba">{% trans "Class" %}: </font>');
              {% endif %}
              document.write('</td></tr>');

              document.write('<tr align="center"><td colspan="2">');
              {% if gamer.race_slot_2 != None %}
                document.write('{{ gamer.race_slot_2 }}');
              {% else %}
                document.write('<font color="ffe5ba">{% trans "Race" %}2: </font>');
              {% endif %}
              document.write('</td><td colspan="2">');
              {% if gamer.class_slot_2 != None %}
                document.write('{{ gamer.class_slot_2 }}');
              {% else %}
                document.write('<font color="ffe5ba">{% trans "Class" %}2: </font>');
              {% endif %}
              document.write('</td></tr>');

              document.write('</table>');

              count = count + 1;
            }
            {% endif %}
          {% endfor %}
          if (count == 0){
            document.write('<font color="DimGray">{% trans "Free place for gamer" %}');
            document.write('<font size="2"><br>{% trans "Chair number" %} '+id+'</font>');
          }
        }
      </script>

</head>
<body>

    {% for gamer in gamers.all %}
        {% if gamer.level >= gamer.game.winning_level %}

        <div id="dialog" title="{% trans 'Do we have a winner' %}?" align="center">
            <p>{% trans 'Is that the end of a game' %}? <br />{% trans 'Oh no' %}!</p>
        </div>
        {% endif %}
    {% endfor %}

    <script>
    $("div#dialog").dialog ({
        modal: true,
        buttons : {
            "{% trans "Yes, that's right" %}!" : function ()
            {
                window.location.href = "{% url 'games:end_game' game.id%}";
            },
            "{% trans 'No, we change rules' %}" : function ()
            {
                window.location.href = "{% url 'games:edit_game' game.id%}";
            }
        }
    }).prev().find(".ui-dialog-titlebar-close").hide ();
    </script>

    <table width="100%" align="center">
      <tr>
        <td align="center">
            <form action="{% url 'home' %}">
               <input type="submit" value="{% trans 'Home' %}" style="font-size:15px" class="red_button"/>
            </form>
        </td>
        <td align="center" style="padding:0 5px 0 5px;"> <font size="6"><b> {{ game.game_code }} </b></font> </td>
        <td align="center" style="padding:0 5px 0 30px;"> <font size="7"><b> {{ game.name }} </b></font> </td>
        <td align="center" style="padding:0 5px 0 5px;"> <font size="2">{% trans 'made by' %}: </font><font size="3"> <b>{{ game.host.username }} </b></font></td>
        <td align="center" style="padding:0 5px 0 5px;"> </font><font size="3"> <b>{{ game.winning_level }}</b></font></td>
        <td align="center">
            <form action="{% url 'games:edit_game' game.id%}">
               <input type="submit" value="{% trans 'Edit' %}" style="font-size:15px" class="blue_button"/>
            </form>
        </td>
      </tr>
    </table>

    <table id="game_panel_table" border="3" cellpadding="5" cellspacing="4" align="center">
      <tr align="center" height="33%">
        <td><font color="DimGray">X</font></td>
        <td width="20%">
    <!-- 1. gamer -->
            <script type="text/javascript">myFunction(1);</script>
        </td>
        <td width="20%">
    <!-- 7. gamer -->
            <script type="text/javascript">myFunction(7);</script>
        </td>
        <td width="20%">
    <!-- 3. gamer -->
            <script type="text/javascript">myFunction(3);</script>
        </td>
        <td width="20%"><font color="DimGray">X</font></td>
      </tr>
      <tr align="center" height="33%">
        <td width="20%">
    <!-- 6. gamer -->
            <script type="text/javascript">myFunction(6);</script>
        </td>
        <td width="20%"><font color="DimGray">X</font></td>
        <td width="20%"><font color="DimGray">X</font></td>
        <td width="20%"><font color="DimGray">X</font></td>
        <td width="20%">
    <!-- 5. gamer -->
            <script type="text/javascript">myFunction(5);</script>
        </td>
      </tr>
      <tr align="center" height="33%">
        <td width="20%"><font color="DimGray">X</font></td>
        <td width="20%">
    <!-- 4. gamer -->
            <script type="text/javascript">myFunction(4);</script>
        </td>
        <td width="20%">
    <!-- 8. gamer -->
            <script type="text/javascript">myFunction(8);</script>
        </td>
        <td width="20%">
    <!-- 2. gamer -->
            <script type="text/javascript">myFunction(2);</script>
        </td>
        <td width="20%"><font color="DimGray">X</font></td>
      </tr>
    </table>

    <br/><br/>

    <script language="javascript" type="text/javascript">
    function isMobileDevice() {
        return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
    };

        if (isMobileDevice() == true){
        document.getElementById('game_panel_table').setAttribute('height', 0.85*window.innerHeight);
        document.getElementById('game_panel_table').setAttribute('width', 0.95*window.innerWidth);
            if (window.innerHeight<window.innerWidth){
                document.getElementById('game_panel_table').style.fontSize = "75%";
            }
            else document.getElementById('game_panel_table').style.fontSize = "90%";
        }
        else {
        document.getElementById('game_panel_table').setAttribute('height', 0.85*window.innerHeight);
        document.getElementById('game_panel_table').setAttribute('width', 0.95*window.innerWidth);
        document.getElementById('game_panel_table').style.fontSize = "90%";
        }
    </script>

</body>
</html>
